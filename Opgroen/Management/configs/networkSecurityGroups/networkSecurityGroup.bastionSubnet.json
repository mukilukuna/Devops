{
  "securityRules": [
    {
      "name": "AllowHttpsInbound",
      "properties": {
        "protocol": "TCP",
        "sourcePortRange": "*",
        "destinationPortRange": "443",
        "sourceAddressPrefix": "Internet",
        "destinationAddressPrefix": "*",
        "access": "Allow",
        "priority": 100,
        "direction": "Inbound",
        "sourcePortRanges": [],
        "destinationPortRanges": [],
        "sourceAddressPrefixes": [],
        "destinationAddressPrefixes": []
      }
    },
    {
      "name": "AllowGatewayManagerInbound",
      "properties": {
        "protocol": "TCP",
        "sourcePortRange": "*",
        "destinationPortRange": "443",
        "sourceAddressPrefix": "GatewayManager",
        "destinationAddressPrefix": "*",
        "access": "Allow",
        "priority": 110,
        "direction": "Inbound",
        "sourcePortRanges": [],
        "destinationPortRanges": [],
        "sourceAddressPrefixes": [],
        "destinationAddressPrefixes": []
      }
    },
    {
      "name": "AllowAzureLoadBalancerInbound",
      "properties": {
        "protocol": "TCP",
        "sourcePortRange": "*",
        "destinationPortRange": "443",
        "sourceAddressPrefix": "AzureLoadBalancer",
        "destinationAddressPrefix": "*",
        "access": "Allow",
        "priority": 120,
        "direction": "Inbound",
        "sourcePortRanges": [],
        "destinationPortRanges": [],
        "sourceAddressPrefixes": [],
        "destinationAddressPrefixes": []
      }
    },
    {
      "name": "AllowBastionHostCommunication",
      "properties": {
        "protocol": "*",
        "sourcePortRange": "*",
        "sourceAddressPrefix": "VirtualNetwork",
        "destinationAddressPrefix": "VirtualNetwork",
        "access": "Allow",
        "priority": 130,
        "direction": "Inbound",
        "sourcePortRanges": [],
        "destinationPortRanges": [
          "8080",
          "5701"
        ],
        "sourceAddressPrefixes": [],
        "destinationAddressPrefixes": []
      }
    },
    {
      "name": "AllowSshRdpOutbound",
      "properties": {
        "protocol": "TCP",
        "sourcePortRange": "*",
        "sourceAddressPrefix": "*",
        "destinationAddressPrefix": "virtualnetwork",
        "access": "Allow",
        "priority": 100,
        "direction": "Outbound",
        "sourcePortRanges": [],
        "destinationPortRanges": [
          "22",
          "3389"
        ],
        "sourceAddressPrefixes": [],
        "destinationAddressPrefixes": []
      }
    },
    {
      "name": "AllowAzureCloudOutbound",
      "properties": {
        "protocol": "TCP",
        "sourcePortRange": "*",
        "sourceAddressPrefix": "*",
        "destinationPortRange": "443",
        "destinationAddressPrefix": "AzureCloud",
        "access": "Allow",
        "priority": 110,
        "direction": "Outbound",
        "sourcePortRanges": [],
        "sourceAddressPrefixes": [],
        "destinationAddressPrefixes": []
      }
    },
    {
      "name": "AllowBastioncommunication",
      "properties": {
        "protocol": "*",
        "sourcePortRange": "*",
        "sourceAddressPrefix": "*",
        "destinationAddressPrefix": "virtualnetwork",
        "access": "Allow",
        "priority": 120,
        "direction": "Outbound",
        "sourcePortRanges": [],
        "destinationPortRanges": [
          "8080",
          "5701"
        ],
        "sourceAddressPrefixes": [],
        "destinationAddressPrefixes": []
      }
    },
    {
      "name": "AllowGetSessionInformation",
      "properties": {
        "protocol": "*",
        "sourcePortRange": "*",
        "sourceAddressPrefix": "*",
        "destinationPortRange": "80",
        "destinationAddressPrefix": "Internet",
        "access": "Allow",
        "priority": 130,
        "direction": "Outbound",
        "sourcePortRanges": [],
        "sourceAddressPrefixes": [],
        "destinationAddressPrefixes": []
      }
    },
    {
      "name": "Deny-VirtualNetwork-VirtualNetwork-Traffic",
      "properties": {
        "description": "Default deny VirtualNetwork to VirtualNetwork traffic to ensure zero trust model",
        "protocol": "*",
        "sourcePortRange": "*",
        "destinationPortRange": "*",
        "sourceAddressPrefix": "*",
        "destinationAddressPrefix": "*",
        "access": "Deny",
        "priority": 4096,
        "direction": "Inbound",
        "sourcePortRanges": [],
        "destinationPortRanges": [],
        "sourceAddressPrefixes": [],
        "destinationAddressPrefixes": []
      }
    }
  ]
}