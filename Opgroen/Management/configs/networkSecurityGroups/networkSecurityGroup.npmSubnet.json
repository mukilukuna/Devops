{
  "securityRules": [
    {
      "name": "Allow-ICMP-Traffic",
      "properties": {
        "protocol": "ICMP",
        "sourcePortRange": "*",
        "destinationPortRange": "*",
        "sourceAddressPrefix": "VirtualNetwork",
        "access": "Allow",
        "priority": 100,
        "direction": "Inbound",
        "sourcePortRanges": [],
        "destinationPortRanges": [],
        "sourceAddressPrefixes": [],
        "destinationAddressPrefixes": [],
        "destinationApplicationSecurityGroups": [
          {
            "id": "*<mgmtWeu-applicationSecurityGroupNpm_ResourceId>*"
          }
        ]
      }
    },
    {
      "name": "AllowBastion",
      "properties": {
        "protocol": "*",
        "sourcePortRange": "*",
        "sourceAddressPrefix": "*<addressSpacePrefix>*.64/26",
        "destinationAddressPrefix": "VirtualNetwork",
        "access": "Allow",
        "priority": 1000,
        "direction": "Inbound",
        "sourcePortRanges": [],
        "destinationPortRanges": [
          "3389",
          "22"
        ],
        "sourceAddressPrefixes": [],
        "destinationAddressPrefixes": []
      }
    },
    {
      "name": "Deny-VirtualNetwork-VirtualNetwork-Traffic",
      "properties": {
        "description": "Default deny VirtualNetwork to VirtualNetwork traffic to ensure zero trust model",
        "protocol": "*",
        "sourcePortRange": "*",
        "destinationPortRange": "*",
        "sourceAddressPrefix": "*",
        "destinationAddressPrefix": "*",
        "access": "Deny",
        "priority": 4096,
        "direction": "Inbound",
        "sourcePortRanges": [],
        "destinationPortRanges": [],
        "sourceAddressPrefixes": [],
        "destinationAddressPrefixes": []
      }
    }
  ]
}