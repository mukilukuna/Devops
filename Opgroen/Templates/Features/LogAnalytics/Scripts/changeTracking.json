{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "workspaceName": {
            "type": "string",
            "metadata": {
                "description": "The name of the log analytics workspace to deploy this upon"
            }
        }
    },
    "variables": {},
    "resources": [
        {
            "name": "[concat(parameters('workspaceName'), '/ChangeTrackingServices_CollectionFrequency')]",
            "type": "Microsoft.OperationalInsights/workspaces/dataSources",
            "apiVersion": "2015-11-01-preview",
            "location": "[resourceGroup().location]",
            "kind": "ChangeTrackingServices",
            "comments": "The Collection Time Interval is in seconds",
            "properties": {
                "ListType": "Blacklist",
                "CollectionTimeInterval": 12
            }
        },
        {
            "name": "[concat(parameters('workspaceName'), '/ChangeTrackingDataTypeConfiguration_FileRecursive')]",
            "type": "Microsoft.OperationalInsights/workspaces/dataSources",
            "apiVersion": "2015-11-01-preview",
            "location": "[resourceGroup().location]",
            "kind": "ChangeTrackingDataTypeConfiguration",
            "comments": "Adding one file requires two PUT calls. Also each file needs to be added individually",
            "properties": {
                "DataTypeId": "FileRecursive",
                "Enabled": "false"
            }
        },

        {
            "name": "[concat(parameters('workspaceName'), '/ChangeTrackingWindows_HostsFile')]",
            "type": "Microsoft.OperationalInsights/workspaces/dataSources",
            "apiVersion": "2015-11-01-preview",
            "location": "[resourceGroup().location]",
            "kind": "ChangeTrackingCustomPath",
            "comments": "Adding hosts file",
            "properties": {
                "checksum": "MD5",
                "enabled": true,
                "groupTag": "Security",
                "path": "%winDir%\\System32\\Drivers\\etc\\hosts",
                "pathType": "File",
                "recurse": false
            }
        },
        {
            "name": "[concat(parameters('workspaceName'), '/ChangeTrackingLinux_networkfolder')]",
            "type": "Microsoft.OperationalInsights/workspaces/dataSources",
            "apiVersion": "2015-11-01-preview",
            "location": "[resourceGroup().location]",
            "kind": "ChangeTrackingLinuxPath",
            "comments": "Adding linux network file",
            "properties": {
                "checksum": "MD5",
                "enabled": true,
                "groupTag": "custom",
                "destinationPath": "/etc/networks/*.*",
                "pathType": "File",
                "recurse": true,
                "useSudo": "true",
                "type": "File",
                "MaxContentsReturnable": "5000000",
                "MaxOutputSize": "5000000",
                "links": "Follow"
            }
        }
    ],
    "outputs": {}
}